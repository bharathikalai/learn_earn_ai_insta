<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TVK AI Assistant</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #8B0000 0%, #DC143C 30%, #FFD700 50%, #FF8C00 70%, #CD5C5C 100%);
      min-height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
    }

    /* Animated Background Grid - Tamil Pattern */
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 2px 2px, rgba(255, 215, 0, 0.15) 1px, transparent 0);
      background-size: 40px 40px;
      animation: gridMove 25s linear infinite;
      pointer-events: none;
    }

    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(40px, 40px); }
    }

    /* Floating Orbs - Red and Yellow */
    body::after {
      content: '';
      position: absolute;
      top: 20%;
      left: 10%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.2) 0%, transparent 70%);
      border-radius: 50%;
      animation: float 20s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) translateX(0); }
      50% { transform: translateY(-50px) translateX(50px); }
    }

    /* Floating Chat Button */
    #chatButton {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      color: #FFD700;
      border: 3px solid #FFD700;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      font-size: 32px;
      cursor: pointer;
      box-shadow: 
        0 8px 32px rgba(220, 20, 60, 0.4),
        0 0 40px rgba(255, 215, 0, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
    }

    #chatButton:hover {
      transform: scale(1.1) rotate(5deg);
      box-shadow: 
        0 12px 48px rgba(220, 20, 60, 0.5),
        0 0 60px rgba(255, 215, 0, 0.3);
    }

    #chatButton:active {
      transform: scale(0.95);
    }

    /* Chat Window */
    #chatWindow {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100vh;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1a3e 50%, #0f0f1e 100%);
      backdrop-filter: blur(20px);
      border: 0;
      border-radius: 0;
      box-shadow: none;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      font-family: sans-serif;
      z-index: 9998;
      animation: chatSlideIn 0.3s ease-out;
    }

    @keyframes chatSlideIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .chatContainer {
      max-width: 1000px;
      margin: 0 auto;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      padding: 20px;
    }

    #chatHeader {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border-bottom: 2px solid rgba(255, 215, 0, 0.3);
      color: #FFD700;
      padding: 20px 30px;
      font-size: 24px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: space-between;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      border-radius: 20px 20px 0 0;
    }


    .closeChatBtn {
      background: transparent;
      border: 2px solid rgba(255, 215, 0, 0.5);
      color: #FFD700;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .closeChatBtn:hover {
      background: rgba(255, 215, 0, 0.2);
      border-color: rgba(255, 215, 0, 0.8);
      transform: rotate(90deg);
    }

    #chatMessages {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      font-size: 16px;
      background: transparent;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* Custom Scrollbar */
    #chatMessages::-webkit-scrollbar {
      width: 8px;
    }

    #chatMessages::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    #chatMessages::-webkit-scrollbar-thumb {
      background: rgba(255, 215, 0, 0.5);
      border-radius: 10px;
    }

    #chatMessages::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 215, 0, 0.7);
    }

    .message {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      max-width: 70%;
      animation: fadeIn 0.3s ease-out;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .user {
      align-self: flex-end;
      justify-content: flex-end;
      text-align: right;
    }

    .bot {
      align-self: flex-start;
    }

    .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 18px;
      flex-shrink: 0;
    }

    .user .avatar {
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      color: #FFD700;
      box-shadow: 0 4px 12px rgba(220, 20, 60, 0.4);
      border: 2px solid #FFD700;
    }

    .bot .avatar {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      color: #8B0000;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
      border: 2px solid #DC143C;
    }

    .bubble {
      padding: 15px 20px;
      border-radius: 20px;
      word-wrap: break-word;
      overflow-wrap: break-word;
      line-height: 1.6;
      max-width: 100%;
      word-break: break-word;
      font-size: 16px;
    }

    .user .bubble {
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      color: #FFD700;
      box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-bottom-right-radius: 4px;
      font-weight: 500;
    }

    .bot .bubble {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-bottom-left-radius: 4px;
      font-weight: 500;
    }

    #chatInputArea {
      display: flex;
      border-top: 2px solid rgba(255, 215, 0, 0.3);
      background: rgba(0, 0, 0, 0.4);
      padding: 4px;
    }

    #chatInput {
      flex: 1;
      border: none;
      padding: 18px 20px;
      font-size: 16px;
      outline: none;
      background: transparent;
      color: #fff;
    }

    #chatInput::placeholder {
      color: rgba(255, 215, 0, 0.5);
    }

    #sendBtn {
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      color: #FFD700;
      border: 2px solid #FFD700;
      padding: 18px 30px;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      border-radius: 16px;
      transition: all 0.2s ease;
      margin: 4px;
    }

    #sendBtn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 16px rgba(220, 20, 60, 0.5);
      background: linear-gradient(135deg, #FF1744 0%, #B71C1C 100%);
    }

    #sendBtn:active {
      transform: scale(0.95);
    }

    /* Loading Animation */
    .typing-dots {
      display: inline-flex;
      gap: 4px;
    }

    .typing-dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #FFD700;
      animation: typing 1.4s infinite;
    }

    .typing-dots span:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing-dots span:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typing {
      0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.5;
      }
      30% {
        transform: translateY(-8px);
        opacity: 1;
      }
    }

    /* Quick Help Buttons */
    .quickHelpButtons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 12px;
      border-top: 2px solid rgba(255, 215, 0, 0.3);
      border-bottom: 2px solid rgba(255, 215, 0, 0.3);
      background: rgba(0, 0, 0, 0.2);
    }

    .helpBtn {
      flex: 1;
      min-width: calc(50% - 4px);
      padding: 10px 12px;
      background: linear-gradient(135deg, rgba(220, 20, 60, 0.3) 0%, rgba(139, 0, 0, 0.2) 100%);
      color: #FFD700;
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 8px;
    }

    .helpBtn div {
      text-align: left;
      line-height: 1.3;
    }

    .helpBtn small {
      font-size: 10px;
      opacity: 0.8;
      font-weight: 500;
    }

    .helpBtn:hover {
      background: linear-gradient(135deg, rgba(220, 20, 60, 0.5) 0%, rgba(139, 0, 0, 0.4) 100%);
      border-color: rgba(255, 215, 0, 0.6);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
    }

    .helpBtn:active {
      transform: translateY(0);
    }

    .helpBtn span {
      font-size: 16px;
    }

    /* Main Content Section */
    .mainContent {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    /* Hero Section */
    .hero {
      text-align: center;
      padding: 60px 0;
      margin-bottom: 60px;
    }

    .hero h1 {
      font-size: 3.5rem;
      color: #FFD700;
      text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.5);
      margin-bottom: 20px;
      animation: fadeInDown 1s ease-out;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .hero p {
      font-size: 1.3rem;
      color: #fff;
      margin-bottom: 40px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    /* Leader Section */
    .leaderSection {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 24px;
      padding: 40px;
      margin-bottom: 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .leaderProfile {
      display: flex;
      align-items: center;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .leaderPhoto {
      width: 250px;
      height: 300px;
      border-radius: 20px;
      border: 4px solid #FFD700;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
      color: #FFD700;
      object-fit: cover;
    }

    .leaderPhoto img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 15px;
    }

    .leaderInfo {
      flex: 1;
      min-width: 300px;
      color: #fff;
    }

    .leaderInfo h2 {
      font-size: 2.5rem;
      color: #FFD700;
      margin-bottom: 15px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .leaderInfo h3 {
      font-size: 1.3rem;
      color: #FFD700;
      margin-bottom: 20px;
      opacity: 0.9;
    }

    .leaderInfo p {
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 15px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    /* Gallery Section */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .galleryItem {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease;
    }

    .galleryItem:hover {
      transform: translateY(-10px);
    }

    .galleryImage {
      width: 100%;
      height: 200px;
      background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      color: #FFD700;
      object-fit: cover;
    }

    .galleryImage img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .galleryContent {
      padding: 20px;
      color: #fff;
    }

    .galleryContent h3 {
      color: #FFD700;
      margin-bottom: 10px;
      font-size: 1.3rem;
    }

    .galleryContent p {
      font-size: 1rem;
      line-height: 1.6;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    /* Party Info Section */
    .partyInfo {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 24px;
      padding: 40px;
      margin-bottom: 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .partyInfo h2 {
      font-size: 2.5rem;
      color: #FFD700;
      margin-bottom: 30px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .infoGrid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
    }

    .infoCard {
      text-align: center;
      padding: 25px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      border: 2px solid rgba(255, 215, 0, 0.2);
      transition: all 0.3s ease;
    }

    .infoCard:hover {
      border-color: rgba(255, 215, 0, 0.6);
      transform: translateY(-5px);
    }

    .infoCard .icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .infoCard h3 {
      color: #FFD700;
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .infoCard p {
      color: #fff;
      font-size: 1rem;
      line-height: 1.6;
    }
  </style>
</head>
<body>

  <div class="mainContent">
    <!-- Hero Section -->
    <div class="hero">
      <h1>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æï ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æï‡Æ¥‡Æï‡ÆÆ‡Øç</h1>
      <p>‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Øç‡Æï‡Ææ‡Æ© ‡Æ®‡Øá‡Æ∞‡ÆÆ‡Øç ‡Æµ‡Æ®‡Øç‡Æ§‡ØÅ‡Æµ‡Æø‡Æü‡Øç‡Æü‡Æ§‡ØÅ!</p>
    </div>

    <!-- Leader Section -->
    <div class="leaderSection">
      <div class="leaderProfile">
        <div class="leaderPhoto">
          <img src="vijay-photo.jpg" alt="Vijay - TVK President" />
        </div>
        <div class="leaderInfo">
          <h2>Vijay</h2>
          <h3>President | ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æï ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æï‡Æ¥‡Æï‡ÆÆ‡Øç</h3>
          <p><strong>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æï‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æé‡Æ§‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç</strong></p>
          <p>Vijay, a renowned actor turned politician, founded the Tamilaga Vettri Kazhagam (TVK) party in 2024 with a vision for social justice, equality, and progress for Tamil Nadu.</p>
          <p>The party represents left-of-center values, embracing Ambedkarism, Periyarism, and Marxism principles.</p>
        </div>
      </div>
    </div>

    <!-- Party Gallery -->
    <div class="gallery">
      <div class="galleryItem">
        <div class="galleryImage">
          <img src="flag.jpg" alt="TVK Party Flag" />
        </div>
        <div class="galleryContent">
          <h3>Party Flag</h3>
          <p>Red and maroon top and bottom, with a yellow middle displaying two elephants and a Vaagai flower - symbolizing Tamil heritage.</p>
        </div>
      </div>
      <div class="galleryItem">
        <div class="galleryImage">
          <!-- Replace this with: <img src="meeting.jpg" alt="TVK Meeting" /> -->
          üèõÔ∏è
        </div>
        <div class="galleryContent">
          <h3>Our Mission</h3>
          <p>Social justice, secularism, egalitarianism, and democracy for the people of Tamil Nadu and Puducherry.</p>
        </div>
      </div>
      <div class="galleryItem">
        <div class="galleryImage">
          <!-- Replace this with: <img src="rally.jpg" alt="TVK Rally" /> -->
          üéØ
        </div>
        <div class="galleryContent">
          <h3>Our Goals</h3>
          <p>Build a just society based on equality, eliminate discrimination, and ensure rights for all citizens.</p>
        </div>
      </div>
    </div>

    <!-- Party Information -->
    <div class="partyInfo">
      <h2>‡Æé‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø</h2>
      <div class="infoGrid">
        <div class="infoCard">
          <div class="icon">üåç</div>
          <h3>Foundation</h3>
          <p>Founded on February 2, 2024</p>
        </div>
        <div class="infoCard">
          <div class="icon">üìç</div>
          <h3>Headquarters</h3>
          <p>Chennai, Tamil Nadu</p>
        </div>
        <div class="infoCard">
          <div class="icon">ü§ù</div>
          <h3>President</h3>
          <p>Vijay</p>
        </div>
        <div class="infoCard">
          <div class="icon">üìã</div>
          <h3>General Secretary</h3>
          <p>N. Anand</p>
        </div>
        <div class="infoCard">
          <div class="icon">üí°</div>
          <h3>Ideology</h3>
          <p>Left-of-center</p>
        </div>
        <div class="infoCard">
          <div class="icon">‚öñÔ∏è</div>
          <h3>Values</h3>
          <p>Social Justice & Equality</p>
        </div>
      </div>
    </div>
  </div>

  <button id="chatButton">üí¨</button>

  <div id="chatWindow">
    <div class="chatContainer">
      <div id="chatHeader">
        <div style="display: flex; align-items: center; gap: 10px;">
          <span>üáÆüá≥ ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æï ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æï‡Æ¥‡Æï‡ÆÆ‡Øç</span>
        </div>
        <button class="closeChatBtn" onclick="closeChatWindow()">√ó</button>
      </div>
      <div id="chatMessages"></div>
      <div class="quickHelpButtons">
      <button class="helpBtn" onclick="selectHelp('political')">
        <span>üèõÔ∏è</span>
        <div>‡ÆÖ‡Æ∞‡Æö‡Æø‡ÆØ‡Æ≤‡Øç ‡Æâ‡Æ§‡Æµ‡Æø<br/><small>Political Help</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('medical')">
        <span>üè•</span>
        <div>‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ ‡Æâ‡Æ§‡Æµ‡Æø<br/><small>Medical Help</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('school')">
        <span>üéì</span>
        <div>‡Æ™‡Æ≥‡Øç‡Æ≥‡Æø ‡Æâ‡Æ§‡Æµ‡Æø<br/><small>School Help</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('legal')">
        <span>‚öñÔ∏è</span>
        <div>‡Æö‡Æü‡Øç‡Æü ‡Æâ‡Æ§‡Æµ‡Æø<br/><small>Legal Help</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('employment')">
        <span>üíº</span>
        <div>‡Æµ‡Øá‡Æ≤‡Øà‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡ØÅ<br/><small>Employment</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('housing')">
        <span>üè†</span>
        <div>‡Æµ‡ØÄ‡Æü‡ØÅ<br/><small>Housing</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('pension')">
        <span>üí∞</span>
        <div>‡Æì‡ÆØ‡Øç‡Æµ‡ØÇ‡Æ§‡Æø‡ÆØ‡ÆÆ‡Øç<br/><small>Pension</small></div>
      </button>
      <button class="helpBtn" onclick="selectHelp('rural')">
        <span>üåæ</span>
        <div>‡Æï‡Æø‡Æ∞‡Ææ‡ÆÆ‡ÆÆ‡Øç<br/><small>Rural Support</small></div>
      </button>
    </div>
      <div id="chatInputArea">
        <input type="text" id="chatInput" placeholder="Type your message..." />
        <button id="sendBtn">Send</button>
      </div>
    </div>
  </div>

  <script>
    const chatButton = document.getElementById('chatButton');
    const chatWindow = document.getElementById('chatWindow');
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');

    let firstOpen = true;
    chatButton.addEventListener('click', () => {
      chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
      if (firstOpen && chatWindow.style.display !== 'none') {
        firstOpen = false;
        appendMessage('bot', 'Vanakkam! Welcome to ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æï ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æï‡Æ¥‡Æï‡ÆÆ‡Øç support. Select a quick help option above or type your message below.');
      }
    });

    function closeChatWindow() {
      chatWindow.style.display = 'none';
    }

    async function sendMessage() {
      const message = chatInput.value.trim();
      if (!message) return;

      appendMessage('user', message);
      chatInput.value = '';

      // Show typing animation
      const typingMsg = appendTypingMessage();

      try {
        const webhookUrl = 'https://baru123.app.n8n.cloud/webhook/92c79941-aa33-4f61-8086-632d8497d53b';
        let response;
        let errorOccurred = false;

        // Try direct fetch first
        try {
          response = await fetch(webhookUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            mode: 'cors',
            credentials: 'omit',
            body: JSON.stringify({ chatInput: message })
          });
        } catch (directError) {
          console.log('Direct fetch failed, trying CORS proxies...', directError);
          errorOccurred = true;
          
          // Try different CORS proxies
          const proxies = [
            'https://corsproxy.io/?',
            'https://api.allorigins.win/raw?url=',
            'https://cors-anywhere.herokuapp.com/'
          ];
          
          for (let proxy of proxies) {
            try {
              response = await fetch(proxy + encodeURIComponent(webhookUrl), {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chatInput: message })
              });
              if (response.ok) break;
            } catch (proxyError) {
              console.log('Proxy failed:', proxy, proxyError);
            }
          }
        }

        if (!response || !response.ok) {
          throw new Error(`HTTP error! status: ${response ? response.status : 'No response'}`);
        }

        const data = await response.json().catch(() => ({ output: '‚úÖ Received by server.' }));

        // Replace typing animation with actual response
        typingMsg.remove();
        appendMessage('bot', data.output || '‚úÖ Received by server.');
      } catch (error) {
        typingMsg.remove();
        console.error('Error details:', error);
        appendMessage('bot', '‚ùå Error: Could not connect to server. Please check your internet connection or try again later.');
      }
    }

    function appendTypingMessage() {
      const div = document.createElement('div');
      div.className = 'message bot';

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = 'TVK';

      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.innerHTML = '<div class="typing-dots"><span></span><span></span><span></span></div>';

      div.appendChild(avatar);
      div.appendChild(bubble);

      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      return div;
    }

    function appendMessage(sender, text) {
      const div = document.createElement('div');
      div.className = `message ${sender}`;

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = sender === 'user' ? 'You' : 'TVK';

      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.textContent = text;

      div.appendChild(avatar);
      div.appendChild(bubble);

      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      return div;
    }

    sendBtn.addEventListener('click', sendMessage);
    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    // Quick Help Button Handler
    function selectHelp(helpType) {
      const helpMessages = {
        political: 'I need help with political party registration, membership, or information about TVK party activities.',
        medical: 'I need medical assistance, health services, or information about government health schemes.',
        school: 'I need help with school admissions, scholarships, or education support.',
        legal: 'I need legal assistance, help with documentation, or legal advice.',
        employment: 'I need help finding employment, job training, or employment schemes.',
        housing: 'I need help with housing schemes, home loans, or housing applications.',
        pension: 'I need information about pension schemes or help applying for pensions.',
        rural: 'I need rural development support, agricultural assistance, or farming help.'
      };

      chatInput.value = helpMessages[helpType] || 'I need help.';
      chatInput.focus();
      
      // Optionally auto-send
      // sendMessage();
    }
  </script>
</body>
</html>
